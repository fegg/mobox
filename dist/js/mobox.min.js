/*!
 * mobox 1.0.1
 * MOBOX = Modern Dialog + Pop Box + Overlay + Extensible CSS3 Effects, Inspired by Codrop&#39;s DialogEffect at github.com/codrops/DialogEffects 
 * @dependencies 
 *  1. classy.js <http://faso.me/classy>
 *  2. modernizr
 * Licensed under the MIT license.
 * http://www.opensource.org/licenses/mit-license.php
 * built at 1428051973091 
 * Copyright 2015, FASO.ME <http://www.faso.me>
 */
!function(t,e){"object"==typeof exports?module.exports=e(require("./classy")):"function"==typeof define&&define.amd?define(["classy"],e):t.Mobox=e(t.classy)}(this,function(t){function e(e,n){o(e,function(e){t.toggle(e,n)})}function o(t,e){for(var o=t.length,n=0;o>n;n++)e(t[n])}function n(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);return t}function i(o,s){this.el=o,this.options=n({morphDurationOpen:parseInt(o.getAttribute("data-morph-open-duration")||1500),morphDurationClose:parseInt(o.getAttribute("data-morph-close-duration")||250),morphOpenDelay:parseInt(o.getAttribute("data-morph-open-delay")||0),morphCloseDelay:parseInt(o.getAttribute("data-morph-close-delay")||0),morphOpenData:o.getAttribute("data-morph-open")||null,morphCloseData:o.getAttribute("data-morph-close")||null,morphTag:o.getAttribute("data-morph-tag")||"path",morphOpenEffect:o.getAttribute("data-morph-open-effect")||"elastic",morphCloseEffect:o.getAttribute("data-morph-close-effect")||"easeout",sticky:!1,actions:{btnIdXXX:function(){}},effect:o.getAttribute("data-effect")||i.defaults.effect,effectRel:o.getAttribute("data-effect-rel")||i.defaults.effectRel},this.options),n(this.options,s),this.ctrlClose=this.el.querySelectorAll("[data-mobox-close]"),this.elemsRel=document.querySelectorAll(this.options.effectRel),this.effectClass="mobox-effect-"+this.options.effect,e(this.elemsRel,this.effectClass+"-rel"),t.add(o,this.effectClass),this._initSvg(),this.isOpen=!1,this._initEvents()}var s={animations:Modernizr.cssanimations},a={WebkitAnimation:"webkitAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd",animation:"animationend"},r=a[Modernizr.prefixed("animation")],p=function(t,e){var o=function(t){if(s.animations){if(t.target!=this)return;this.removeEventListener(r,o)}e&&"function"==typeof e&&e.call()};s.animations?t.addEventListener(r,o):o()};return i.prototype.options={onOpen:function(){return!1},onClose:function(){return!1}},i.prototype._initSvg=function(){var t=this.el.querySelector(".mobox-morph-shape"),e=t?t.querySelector("svg"):null;if(e&&t){if("undefined"==typeof Snap)return void alert("Snap.svg not found! SVG Mobox need Snap.svn to function properly!");var o=Snap(e),n=this.options.morphTag,i={},s={},a=s[n]=this.options.morphCloseData,r=i[n]=this.options.morphOpenData;this.svg={morph:{openData:r,closeData:a,open:i,close:s,target:o.select(n)},onOpen:function(t){if(t.svg.morph.openData){var e=t.svg.morph;return 0===t.options.morphOpenDelay?e.target.stop().animate(e.open,t.options.morphDurationOpen,mina[t.options.morphOpenEffect]):void setTimeout(function(){e.target.stop().animate(e.open,t.options.morphDurationOpen,mina[t.options.morphOpenEffect])},t.options.morphOpenDelay)}},onClose:function(t){if(t.svg.morph.closeData){var e=t.svg.morph;return 0===t.options.morphCloseDelay?e.target.stop().animate(e.close,t.options.morphDurationClose,mina[t.options.morphCloseEffect]):void setTimeout(function(){e.target.stop().animate(e.close,t.options.morphDurationClose,mina[t.options.morphCloseEffect])},t.options.morphCloseDelay)}}}}},i.prototype._initEvents=function(){var t=this;o(this.ctrlClose,function(e){e.addEventListener("click",t.hide.bind(t))}),document.addEventListener("keydown",function(e){var o=e.keyCode||e.which;27===o&&t.isOpen&&t.hide()}),this.options.sticky||this.el.querySelector(".mobox-overlay").addEventListener("click",this.hide.bind(this));for(var e in this.options.actions){var n=document.getElementById(e),i=this.options.actions[e],s=i.evtName?i.func:i;evtName=i.evtName||"click",n&&!function(e){e.el.addEventListener(e.evtName,function(){e.action.call(t,e)})}({el:n,evtName:evtName,actionKey:e,action:s})}},i.prototype.show=function(){this.isOpen||(t.add(this.el,"mobox-open"),e(this.elemsRel,this.effectClass+"-open"),this.options.onOpen(this),this.svg&&this.svg.onOpen(this),this.isOpen=!0)},i.prototype.hide=function(){var o=this;this.isOpen&&(t.remove(this.el,"mobox-open"),e(this.elemsRel,this.effectClass+"-open"),t.add(o.el,"mobox-close"),p(this.el.querySelector(".mobox-inner"),function(){t.remove(o.el,"mobox-close")}),this.options.onClose(this),this.svg&&this.svg.onClose(this),this.isOpen=!1)},i.prototype.toggle=function(){return this.isOpen?this.hide():this.show()},i.defaults={effect:"lv",effectRel:"body",svgEffects:["dg","panther","lava","anna"]},i.isSvgEffect=function(t){for(var e=i.defaults.svgEffects,o=e.length,n=!1,s=0;o>s;s++)if(t===e[s]){n=!0;break}return n},i});