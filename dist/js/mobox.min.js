/*!
 * mobox 1.0.4
 * Modern Dialog Width Extensible CSS3 Effects, Inspired by Codrop&#39;s DialogEffect at github.com/codrops/DialogEffects 
 * @dependencies 
 *  1. classy.js <http://faso.me/classy>
 *  2. modernizr
 * Licensed under the MIT license.
 * http://www.opensource.org/licenses/mit-license.php
 * built at 1428480738338 
 * Copyright 2015, FASO.ME <http://www.faso.me>
 */
!function(e,t){"object"==typeof exports?module.exports=t(require("./classy")):"function"==typeof define&&define.amd?define(["classy"],t):e.Mobox=t(e.classy)}(this,function(e){function t(t,n){o(t,function(t){e.toggle(t,n)})}function o(e,t){for(var o=e.length,n=0;o>n;n++)t(e[n])}function n(e,t){return e&&e.tagName&&e.nodeName&&1===e.nodeType&&(t?t===e.tagName:!0)}function i(e,t){return e?"string"==typeof e?document.getElementById(e):n(e,t)?e:null:null}function s(e){var t=document.createElement("div"),o=!1;return n(e,"SCRIPT")?t.innerHTML=e.innerHTML:"string"==typeof e?-1!==e.indexOf("<")&&-1!==e.indexOf(">")?t.innerHTML=e:(e=document.getElementById(e))?t.innerHTML=e.innerHTML:t=null:t=null,t&&t.children[0]?(t=t.children[0],t.id||(o=!0,t.id="mobox-"+h++),document.body.appendChild(t),{dynamic:o,dom:t}):null}function r(e,t){o(e,function(e){if("object"==typeof t&&t.attrs)for(var o in t.attrs)e.setAttribute(o,t.attrs[o]);else"INPUT"!==e.tagName||"checkbox"!==e.type&&"radio"!==e.type?"undefined"!=typeof e.value?e.value=t:"undefined"!=typeof e.innerHTML&&(e.innerHTML=t):e.checked=!!t})}function a(e,t){var o,n;for(var i in t)o=e.querySelectorAll(".mobox-"+i),n=t[i],o.length>0&&r(o,n),o=e.querySelectorAll("[data-"+i+"]"),0!==o.length&&r(o,n)}function p(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e}function l(o,n){this.el=o,this.options=p({morphDurationOpen:parseInt(o.getAttribute("data-morph-open-duration")||1500),morphDurationClose:parseInt(o.getAttribute("data-morph-close-duration")||250),morphOpenDelay:parseInt(o.getAttribute("data-morph-open-delay")||0),morphCloseDelay:parseInt(o.getAttribute("data-morph-close-delay")||0),morphOpenData:o.getAttribute("data-morph-open")||null,morphCloseData:o.getAttribute("data-morph-close")||null,morphTag:o.getAttribute("data-morph-tag")||"path",morphOpenEffect:o.getAttribute("data-morph-open-effect")||"elastic",morphCloseEffect:o.getAttribute("data-morph-close-effect")||"easeout",actions:{btnIdXXX:function(){}},effect:o.getAttribute("data-effect")||l.defaults.effect,effectRel:o.getAttribute("data-effect-rel")||l.defaults.effectRel},this.options),p(this.options,n),this.ctrlClose=this.el.querySelectorAll("[data-mobox-close]"),this.elemsRel=document.querySelectorAll(this.options.effectRel),this.effectClass="mobox-effect-"+this.options.effect,t(this.elemsRel,this.effectClass+"-rel"),e.add(o,this.effectClass),this._initSvg(),this.isOpen=!1,this._initEvents(),this._initScenes()}var c={animations:Modernizr.cssanimations},h=1,f={WebkitAnimation:"webkitAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd",animation:"animationend"},u=f[Modernizr.prefixed("animation")],d=function(e,t){var o=function(e){if(c.animations){if(e.target!=this)return;this.removeEventListener(u,o)}t&&"function"==typeof t&&t.call()};c.animations?e.addEventListener(u,o):o()};return l.prototype.destroy=function(){this.el.parentNode.removeChild(this.el)},l.prototype.options={sticky:!1,clScene:"mobox-scene",clSceneActive:"mobox-scene-active",destroyAfterClosed:!1,onOpen:function(){return!1},onOpened:function(){return!1},onClose:function(){return!1},onClosed:function(){return!1}},l.prototype._initSvg=function(){var e=this.el.querySelector(".mobox-morph-shape"),t=e?e.querySelector("svg"):null;if(t&&e){if("undefined"==typeof Snap)return void alert("Snap.svg not found! SVG Mobox need Snap.svn to function properly!");var o=Snap(t),n=this.options.morphTag,i={},s={},r=s[n]=this.options.morphCloseData,a=i[n]=this.options.morphOpenData;this.svg={morph:{openData:a,closeData:r,open:i,close:s,target:o.select(n)},onOpen:function(e){if(e.svg.morph.openData){var t=e.svg.morph;return 0===e.options.morphOpenDelay?t.target.stop().animate(t.open,e.options.morphDurationOpen,mina[e.options.morphOpenEffect]):void setTimeout(function(){t.target.stop().animate(t.open,e.options.morphDurationOpen,mina[e.options.morphOpenEffect])},e.options.morphOpenDelay)}},onClose:function(e){if(e.svg.morph.closeData){var t=e.svg.morph;return 0===e.options.morphCloseDelay?t.target.stop().animate(t.close,e.options.morphDurationClose,mina[e.options.morphCloseEffect]):void setTimeout(function(){t.target.stop().animate(t.close,e.options.morphDurationClose,mina[e.options.morphCloseEffect])},e.options.morphCloseDelay)}}}}},l.prototype._initScenes=function(){this.scenes=this.el.querySelectorAll("."+this.options.clScene)},l.prototype.showScene=function(t,n){n=n||{};var i,s=this;t=this.options.clScene+"-"+(t||"default"),o(this.scenes,function(o){e.remove(o,s.options.clSceneActive),e.has(o,t)&&!i&&(i=o)}),i&&(a(i,n),e.add(i,s.options.clSceneActive))},l.prototype._initEvents=function(){var e=this;o(this.ctrlClose,function(t){t.addEventListener("click",e.hide.bind(e))}),document.addEventListener("keydown",function(t){var o=t.keyCode||t.which;27===o&&e.isOpen&&e.hide()}),this.options.sticky||this.el.querySelector(".mobox-overlay").addEventListener("click",this.hide.bind(this));for(var t in this.options.actions){var n=document.getElementById(t),i=this.options.actions[t],s=i.evtName?i.func:i;evtName=i.evtName||"click",n&&!function(t){t.el.addEventListener(t.evtName,function(){t.action.call(e,t)})}({el:n,evtName:evtName,actionKey:t,action:s})}},l.prototype.show=function(o){o=this.options.data=o||{};var n=this;return a(this.el,o),this.isOpen?this:(e.add(this.el,"mobox-open"),t(this.elemsRel,this.effectClass+"-open"),d(this.el.querySelector(".mobox-inner"),function(){n.options.onOpened(n)}),this.options.onOpen(this),this.svg&&this.svg.onOpen(this),this.isOpen=!0,this)},l.prototype.hide=function(){var o=this;this.isOpen&&(e.remove(this.el,"mobox-open"),t(this.elemsRel,this.effectClass+"-open"),e.add(o.el,"mobox-close"),this.options.onClose(this),this.svg&&this.svg.onClose(this),d(this.el.querySelector(".mobox-inner"),function(){e.remove(o.el,"mobox-close"),o.options.destroyAfterClosed&&o.destroy(),o.options.onClosed(o)}),this.isOpen=!1)},l.prototype.toggle=function(){return this.isOpen?this.hide():this.show()},l.defaults={effect:"lv",effectRel:"body",svgEffects:["dg","panther","lava","anna"]},l.isSvgEffect=function(e){for(var t=l.defaults.svgEffects,o=t.length,n=!1,i=0;o>i;i++)if(e===t[i]){n=!0;break}return n},l.create=function(e){e=e||{},"undefined"==typeof e.autoShow&&(e.autoShow=!0);var t=e.dom,o=e.tpl,n=null;return t=i(t),delete e.dom,delete e.tpl,t?(n=new l(t,e),e.autoShow?n.show():n):(t=s(o))?(e.destroyAfterClosed=t.dynamic,n=new l(t.dom,e),e.autoShow?n.show():n):(alert('Invalid parameters! The parameter "options" must contain a property named either "dom" or "tpl"! '),null)},l});